<div class="space-y-3" id="checklist">
    {% for item in checklist_items %}
    <div class="flex items-start gap-3 p-3 rounded {% if item.completed %}bg-green-50{% else %}bg-gray-50{% endif %}">
        <form method="post" action="{% url 'appeals:appeal_toggle_step' appeal.pk %}"
              hx-post="{% url 'appeals:appeal_toggle_step' appeal.pk %}"
              hx-target="#checklist-section"
              hx-swap="innerHTML">
            {% csrf_token %}
            <input type="hidden" name="step_id" value="{{ item.id }}">
            <button type="submit"
                    class="mt-1 w-5 h-5 rounded border-2 flex items-center justify-center
                    {% if item.completed %}bg-green-600 border-green-600 text-white{% else %}border-gray-400 hover:border-blue-500{% endif %}"
                    aria-label="{% if item.completed %}Mark {{ item.task }} as incomplete{% else %}Mark {{ item.task }} as complete{% endif %}">
                {% if item.completed %}
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                </svg>
                {% endif %}
            </button>
        </form>
        <div class="flex-1">
            <p class="{% if item.completed %}text-gray-500 line-through{% else %}text-gray-900{% endif %}">
                {{ item.task }}
            </p>
            {% if item.timing %}
            <p class="text-xs text-gray-500 mt-1">{{ item.timing }}</p>
            {% endif %}
        </div>
        {% if item.priority == 'high' or item.priority == 'critical' %}
        <span class="text-xs px-2 py-1 rounded {% if item.priority == 'critical' %}bg-red-100 text-red-700{% else %}bg-yellow-100 text-yellow-700{% endif %}">
            {{ item.priority|title }}
        </span>
        {% endif %}
    </div>
    {% empty %}
    <p class="text-gray-500 text-sm">No checklist items available.</p>
    {% endfor %}
</div>
